---
title: Repository
sidebar_label: Repository
---

# Repository

**Extends:** [Emitter](./emitter)

## Constructor

```typescript
new Repository(db: [GoatDB](./classes/goatdb)<`Schema`>, path: string, trustPool: `TrustPool`<>, __namedParameters: `RepositoryConfig`<`ST`>)
```

## Methods

### changedFieldsInCommit()

```typescript
changedFieldsInCommit(commit: string | `Commit`<>): string[]
```

This method computes a quick diff between the given commit and all of its
parents. It determines which fields were changed in this commit, rather
than what the changes were.

### commitIsCorrupted()

```typescript
commitIsCorrupted(c: `Commit`<>): boolean
```

### commitIsHighProbabilityLeaf()

```typescript
commitIsHighProbabilityLeaf(candidate: string | `Commit`<>): boolean
```

This method determines, to a high probability, whether the given commit is
a leaf commit or not, even when the full graph isn't available.

It works by inspecting the bloom filters of the newest 2log\[4\]\(N\) commits,
and checking for the presence of the candidate commit. If present in all
filters, the commit guaranteed not to be a leaf.

### commits()

```typescript
commits(session: `Session`): `Generator`<`Commit`<>, any, unknown>
```

### commitsForKey()

```typescript
commitsForKey(key: string, session: `Session`): `Generator`<`Commit`<>, any, unknown>
```

### create()

```typescript
create(key: string, value: [Item](./classes/item)<S>): `Promise`<`Commit`<>>
```

### debugNetworkForKey()

```typescript
debugNetworkForKey(key: string): [ReadonlyJSONObject](./interfaces/readonlyjsonobject)
```

### downloadDebugNetworkForKey()

```typescript
downloadDebugNetworkForKey(key: string): void
```

### findLatestAncestorFromCommit()

```typescript
findLatestAncestorFromCommit(commit: string | `Commit`<>, filter: unknown): `Commit`<>
```

### findLatestNonCorruptedCommitForKey()

```typescript
findLatestNonCorruptedCommitForKey(key: string): `Commit`<>
```

### findMergeBase()

```typescript
findMergeBase(commits: `Commit`<>[]): unknown
```

Given an iterable of commits, this method returns their Lowest Common
Ancestor or undefined if no such ancestor exists (meaning the commits
belong to disconnected histories).

### findNonCorruptedParentsFromCommits()

```typescript
findNonCorruptedParentsFromCommits(parents: string | `Commit`<>[]): `Commit`<>[]
```

### getCommit()

```typescript
getCommit(id: string, session: `Session`): `Commit`<>
```

### graphForKey()

```typescript
graphForKey(key: string): `CommitGraph`[]
```

### hasCommit()

```typescript
hasCommit(id: string): boolean
```

### hasItemForCommit()

```typescript
hasItemForCommit(c: string | `Commit`<>): boolean
```

### hasKey()

```typescript
hasKey(key: string): boolean
```

### headForKey()

```typescript
headForKey(key: string): `Commit`<>
```

This method finds and returns the head for the given key. This is a
readonly operation and does not attempt to merge any leaves.

### itemForCommit()

```typescript
itemForCommit(c: string | `Commit`<>): [Item](./classes/item)<S>
```

### keyExists()

```typescript
keyExists(key: string): boolean
```

### keys()

```typescript
keys(session: `Session`): `Iterable`<string>
```

### leavesForKey()

```typescript
leavesForKey(key: string, session: `Session`): unknown
```

### mergeIfNeeded()

```typescript
mergeIfNeeded(key: string): `Promise`<`Commit`<>>
```

### numberOfCommits()

```typescript
numberOfCommits(session: `Session`): number
```

### paths()

```typescript
paths(session: `Session`): `Iterable`<string>
```

### persistCommits()

```typescript
persistCommits(commits: `Iterable`<`Commit`<>>): `Promise`<`Commit`<>[]>
```

### persistVerifiedCommits()

```typescript
persistVerifiedCommits(commits: `Iterable`<`Commit`<>>): `Promise`<`Commit`<>[]>
```

### rebase()

```typescript
rebase(key: string, record: [Item](./classes/item)<S>, headId: string | `Commit`<>): unknown
```

Given a key and an edited record for this key, this method rebases the
changes from the record on top of the any changes made concurrently for
this key. Use it to merge remote changes with any local edits before
committing them.

### revertAllKeysToBefore()

```typescript
revertAllKeysToBefore(ts: number): void
```

### revertHeadsByConnectionId()

```typescript
revertHeadsByConnectionId(connectionIds: string | string[]): void
```

### setValueForKey()

```typescript
setValueForKey(key: string, value: [Item](./classes/item)<S>, parentCommit: string | `Commit`<>): `Promise`<`Commit`<>>
```

Updates the head record for a given key.

### valueForKey()

```typescript
valueForKey(key: string): unknown
```

### verifyCommits()

```typescript
verifyCommits(commits: `Iterable`<`Commit`<>>): `Promise`<`Commit`<>[]>
```

### normalizePath()

```typescript
normalizePath(id: string): string
```

### parseId()

```typescript
parseId(id: string): unknown
```

### path()

```typescript
path(storage: string, id: string): string
```

## Inherited Methods

### From [Emitter](./emitter)

`attach()`, `detach()`, `detachAll()`, `emit()`, `mute()`, `once()`, `resume()`, `suspend()`, `unmute()`

*See [Emitter](./emitter) for detailed documentation*

