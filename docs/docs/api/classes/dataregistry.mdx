---
title: DataRegistry
sidebar_label: DataRegistry
---

# DataRegistry

The DataRegistry acts as a registry of known schemas for a given GoatDB
instance. It's initialized when the app starts and stays fixed during its
execution.

Typically, apps use the `DataRegistry.default` instance, but are free to
create multiple registries each with different schemas registered.

## Constructor

```typescript
new DataRegistry()
```

Initialize a new DataRegistry.

## Methods

### authRuleForRepo()

```typescript
authRuleForRepo(inputPath: string): `AuthRule`
```

Finds the authorization rule for the provided path.

### decode()

```typescript
decode(str: string): `Schema`
```

Decodes a schema marker to an actual schema.

### encode()

```typescript
encode(schema: `Schema`): string
```

Encodes a schema to a marker string for storage.

### get()

```typescript
get(ns: string, version: number): `Schema`
```

Find a schema that's been registered with this registry.

### registerAuthRule()

```typescript
registerAuthRule(path: string | `RegExp`<>, rule: `AuthRule`): void
```

Registers an authorization rule with this registry. If not provided, all
data is considered public.

### registerSchema()

```typescript
registerSchema(schema: `Schema`): void
```

Registers a schema with this registry. This is a NOP if the schema had
already been registered.

### upgrade()

```typescript
upgrade(data: [CoreObject](./interfaces/coreobject)<`CoreValue`>, dataSchema: `Schema`, targetSchema: `Schema`): unknown
```

Given a data object and its schema, this method performs the upgrade
procedure to the target schema.

This method will refuse to upgrade to the target schema if a single version
is missing. For example, if attempting to upgrade from v1 to v3, but the
v2 schema is missing, then the upgrade will be refused.

NOTE: You shouldn't use this method directly under normal circumstances.
The upgrade procedure will be performed automatically for you when needed.

