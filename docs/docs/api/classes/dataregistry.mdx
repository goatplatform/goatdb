---
title: DataRegistry
sidebar_label: DataRegistry
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# DataRegistry

The DataRegistry acts as a registry of known schemas for a given GoatDB
instance. It's initialized when the app starts and stays fixed during its
execution.

Typically, apps use the `DataRegistry.default` instance, but are free to
create multiple registries each with different schemas registered.

## Constructor

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
new DataRegistry()
```

  </TabItem>
</Tabs>

## Properties

### default *(readonly)*

The default instance. Unless explicitly specified, GoatDB will default to
this instance.

**Type:** `DataRegistry`

## Methods

### registerSchema()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
registerSchema(schema: Schema): void
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### schema

**Type:** `Schema`

The schema to register.

  </TabItem>
</Tabs>

**Returns:** `void`

### registerAuthRule()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
registerAuthRule(path: string | RegExp, rule: AuthRule): void
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### path

**Type:** `string | RegExp`

Path to a repository or a RegExp instance.

#### rule

**Type:** `AuthRule`

A function responsible for authorizing single items within
            repositories that match the given path.

  </TabItem>
</Tabs>

**Returns:** `void`

### get()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
get(ns: string, version?: number): Schema
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### ns

**Type:** `string`

The namespace for the schema.

#### version *(optional)*

**Type:** `number`

If provided, searches for the specific version. Otherwise
               this method will return the latest version for the passed
               namespace.

  </TabItem>
</Tabs>

**Returns:** `Schema`

### upgrade()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
upgrade(data: CoreObject, dataSchema: Schema, targetSchema?: Schema): [CoreObject<CoreValue>, Schema]
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### data

**Type:** `CoreObject`

The data to upgrade.

#### dataSchema

**Type:** `Schema`

The schema of the passed data.

#### targetSchema *(optional)*

**Type:** `Schema`

The target schema. If not provided, the latest schema
                    for the namespace will be used.

  </TabItem>
</Tabs>

**Returns:** `[CoreObject<CoreValue>, Schema]`

### encode()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
encode(schema: Schema): string
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### schema

**Type:** `Schema`

The schema to encode.

  </TabItem>
</Tabs>

**Returns:** `string`

### decode()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
decode(str: string): Schema
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### str

**Type:** `string`

The schema marker produced by a previous call to
           `dataRegistry.encode`.

  </TabItem>
</Tabs>

**Returns:** `Schema`

### authRuleForRepo()

<Tabs>
  <TabItem value="signature" label="Signature" default>

```typescript
authRuleForRepo(inputPath: string): AuthRule
```

  </TabItem>
  <TabItem value="params" label="Parameters">

#### inputPath

**Type:** `string`

The path to search for.

  </TabItem>
</Tabs>

**Returns:** `AuthRule`

## See Also

- [Schema Guide](/schema) - Learn about schemas
- [GoatDB](./goatdb) - Uses registry for validation
- [Authorization Rules](/authorization-rules) - Set up auth
